@page "/"
@inject IGameCatalogService Catalog

<PageTitle>GameScout</PageTitle>

<h3>Search games</h3>
<SearchBar OnSearch="Search" />
<SortFilterBar OnApply="SetSort" />

@if (_loading)
{
    <p>Loading...</p>
}
else if (_items.Count == 0)
{

    <p>Nothing found</p>
}
else
{
    foreach (var g in _items)
    {
        <GameCard Game="g" />
    }
}

@code {
    private readonly List<GameSummary> _items = new();
    private bool _loading;
    private SortBy _sort = SortBy.Name;

    private Task SetSort(SortBy s) { _sort = s; return Task.CompletedTask; }
    private Task Search(string? q)
    {
        _loading = true;
        StateHasChanged();
        _items.Clear();
        _loading = false;
        return Task.CompletedTask;
    }

}
